<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mjoindices.empirical_orthogonal_functions &mdash; mjoindices  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> mjoindices
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/apidoc.html">API documentation (for running calculations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/apidoc.html#api-documentation-for-working-with-results">API documentation (for working with results)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/apidoc.html#api-documentation-minor-relevance-for-users">API documentation (minor relevance for users)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References and citation hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../indices.html">Indices and tables</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">mjoindices</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>mjoindices.empirical_orthogonal_functions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for mjoindices.empirical_orthogonal_functions</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># Copyright (C) 2019 Christoph G. Hoffmann. All rights reserved.</span>

<span class="c1"># This file is part of mjoindices</span>

<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>

<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>

<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>

<span class="c1"># Contact: christoph.hoffmann@uni-greifswald.de</span>

<span class="sd">&quot;&quot;&quot; This module provides basic functionality to handle EOF data, which is a basic output of the OMI calculation. &quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">mjoindices.tools</span> <span class="kn">import</span> <span class="n">doy_list</span>


<div class="viewcode-block" id="EOFData"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFData">[docs]</a><span class="k">class</span> <span class="nc">EOFData</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class serves as a container for the EOF data of one pair of EOFs.</span>

<span class="sd">    :param lat: The latitude grid of the EOF data.</span>
<span class="sd">    :param long: The longitude grid of the EOF data.</span>
<span class="sd">    :param eof1: Values of the first EOF. Can either be a 1-dim vector with</span>
<span class="sd">        ``lat.size * long.size`` elements (Start with all values of the first latitude, then all values of the second</span>
<span class="sd">        latitude, etc.) or a 2-dim map with the first index representing the latitude axis and the second index</span>
<span class="sd">        representing longitude axis.</span>
<span class="sd">    :param eof2: Values of the second EOF. Structure similar to ``eof1``</span>
<span class="sd">    :param explained_variances: Fraction of data variance that is explained by each EOF (for all EOFs and not only the</span>
<span class="sd">        first two EOFs). Can  be set to ``None``.</span>
<span class="sd">    :param eigenvalues: Eigenvalue corresponding to each EOF. Can  be set to ``None``.</span>
<span class="sd">    :param no_observations: The number of observations that went into the EOF calculation. Can  be set to ``None``.</span>

<span class="sd">    Note that the explained variances are not independent of the eigenvalues. However, this class is meant only to</span>
<span class="sd">    store the data. Hence, we store redundant data here intentionally to be able to have all computation performed together</span>
<span class="sd">    in another location.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">long</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">eof1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">eof2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
                 <span class="n">explained_variances</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">eigenvalues</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">no_observations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialization with all necessary variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">eof1</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">eof2</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;EOF1 and EOF2 must have the same shape&quot;</span><span class="p">)</span>
        <span class="n">expected_n</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">long</span><span class="o">.</span><span class="n">size</span>

        <span class="k">if</span> <span class="n">eof1</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">expected_n</span> <span class="ow">or</span> <span class="n">eof2</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">expected_n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of elements of EOF1 and EOF2 must be identical to lat.size*long.size&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_lat</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_long</span> <span class="o">=</span> <span class="n">long</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">eof1</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">eof2</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eof1</span> <span class="o">=</span> <span class="n">eof1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eof2</span> <span class="o">=</span> <span class="n">eof2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">eof1</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">eof2</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">eof1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="ow">and</span> <span class="n">eof1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">long</span><span class="o">.</span><span class="n">size</span> <span class="ow">and</span> <span class="n">eof2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="ow">and</span>
                    <span class="n">eof2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of first axis of EOS 1 and 2 must correspond to latitude axis, length of &quot;</span>
                                 <span class="s2">&quot;second axis to the longitude axis&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eof1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_vector</span><span class="p">(</span><span class="n">eof1</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eof2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_vector</span><span class="p">(</span><span class="n">eof2</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;EOF1 and EOF2 must have a dimension of 1 or 2.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">eigenvalues</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">eigenvalues</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof1vector</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Eigenvalues (if not None) must have same length as the second axis of the EOFs&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eigenvalues</span> <span class="o">=</span> <span class="n">eigenvalues</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_eigenvalues</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">explained_variances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">explained_variances</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof1vector</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Explained variances (if not None) must have same length as the second axis of &quot;</span>
                                 <span class="s2">&quot;the EOFs&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span> <span class="o">=</span> <span class="n">explained_variances</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_no_observations</span> <span class="o">=</span> <span class="n">no_observations</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;EOFData&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override the default equals behavior</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eof1vector</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">eof1vector</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eof2vector</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">eof2vector</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">explained_variances</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_eigenvalues</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">)</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_observations</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">no_observations</span><span class="p">)</span>

<div class="viewcode-block" id="EOFData.close"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFData.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;EOFData&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks equality of two :class:`EOFData` objects, but allows for numerical tolerances.</span>

<span class="sd">        :param other: The object to compare with.</span>

<span class="sd">        :return: Equality of all members considering the default tolerances of :func:`numpy.allclose`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eof1vector</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">eof1vector</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eof2vector</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">eof2vector</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">explained_variances</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_eigenvalues</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">)</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_observations</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">no_observations</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The latitude grid of the EOFs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lat</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">long</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The longitude grid of the EOFs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_long</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eof1vector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        EOF1 as a vector (and not a matrix).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eof1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eof2vector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        EOF2 as a vector (and not a matrix).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eof2</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eof1map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        EOF1 as a 2-dimensional map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_eof1</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eof2map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        EOF2 as a 2-dimensional map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_eof2</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">explained_variances</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The explained variances of all EOFs (not only the first two ones).</span>

<span class="sd">        :return: Explained Variances. Might be ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">explained_variance_eof1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The explained variance of EOF1 as fraction between 0 and 1.</span>

<span class="sd">        :return: The variance. Might be ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">explained_variance_eof2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The explained variance of EOF2 as fraction between 0 and 1.</span>

<span class="sd">        :return: The variance. Might be ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sum_of_explained_variances</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the total variance explained by all EOFs.</span>

<span class="sd">        This should be close to 1 if the calculation was successful.</span>

<span class="sd">        :return: The total explained variance. Might be ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_explained_variances</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eigenvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The eigenvalues of all EOFs (not only the first two ones).</span>

<span class="sd">        :return: The eigenvalues. Might be ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eigenvalues</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eigenvalue_eof1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The eigenvalue of EOF1.</span>

<span class="sd">        :return: The eigenvalue. Might be ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eigenvalues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eigenvalue_eof2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The eigenvalue of EOF2.</span>

<span class="sd">        :return: The eigenvalue. Might be ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eigenvalues</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eigenvalues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">no_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The number of observations that went into the calculation of the EOFs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_observations</span>

<div class="viewcode-block" id="EOFData.reshape_to_vector"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFData.reshape_to_vector">[docs]</a>    <span class="k">def</span> <span class="nf">reshape_to_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">map</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reshapes the horizontally distributed data to fit into a vector.</span>

<span class="sd">        The vector elements will contain the values of all longitudes for the first latitude,</span>
<span class="sd">        and then the values of all longitudes for the second latitude, etc.</span>

<span class="sd">        :param map: The 2-dim data. The first dimension must correspond to the latitude grid, the second to the</span>
<span class="sd">            longitude grid.</span>

<span class="sd">        :return: The data as a vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">map</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;eof_map must have 2 dimensions&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="ow">and</span> <span class="nb">map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Length of first dimension of eof_map must correspond to the latitude grid, length of second dimension to the longitude grid&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">map</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></div>

<div class="viewcode-block" id="EOFData.reshape_to_map"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFData.reshape_to_map">[docs]</a>    <span class="k">def</span> <span class="nf">reshape_to_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reshapes data in a vector to fit into a matrix, which corresponds to the present latitude/longitude grid.</span>

<span class="sd">        :param vector: The vector with the data. Must have the length ``lat.size * long.size``.</span>

<span class="sd">        :return: The map. The first index corresponds to the latitude grid, the second to longitude grid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vector</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Vector must have only 1 dimension.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vector</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Vector must have lat.size*long.size elements.&quot;</span><span class="p">)</span>
        <span class="c1"># The following transformation has been double-checked graphically by comparing resulting plot to</span>
        <span class="c1"># https://www.esrl.noaa.gov/psd/mjo/mjoindex/animation/</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">.</span><span class="n">size</span><span class="p">])</span></div>

<div class="viewcode-block" id="EOFData.save_eofs_to_txt_file"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFData.save_eofs_to_txt_file">[docs]</a>    <span class="k">def</span> <span class="nf">save_eofs_to_txt_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves both EOFs to a .txt file.</span>

<span class="sd">        Note that the file format is not exactly that of the original data files. Particularly, both EOFs are written</span>
<span class="sd">        into the same file instead of 2 separate files. Furthermore, the lat/long-grids are also explicitly saved.</span>

<span class="sd">        A suitable reader is provided by the function</span>
<span class="sd">        :py:func:`load_single_eofs_from_txt_file`, whereas a reader for the</span>
<span class="sd">        original files is provided by :py:func:`load_original_eofs_for_doy`</span>

<span class="sd">        :param filename: The full path- and filename.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lat_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eof1vector</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">long_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eof1vector</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i_vec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof1vector</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="c1"># find out lat/long corresponding to the vector position by evaluating the index transformation from map</span>
            <span class="c1"># to vector</span>
            <span class="p">(</span><span class="n">i_lat</span><span class="p">,</span> <span class="n">i_long</span><span class="p">)</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">i_vec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof1map</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">lat_full</span><span class="p">[</span><span class="n">i_vec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">[</span><span class="n">i_lat</span><span class="p">]</span>
            <span class="n">long_full</span><span class="p">[</span><span class="n">i_vec</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">[</span><span class="n">i_long</span><span class="p">]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;Lat&quot;</span><span class="p">:</span> <span class="n">lat_full</span><span class="p">,</span> <span class="s2">&quot;Long&quot;</span><span class="p">:</span> <span class="n">long_full</span><span class="p">,</span> <span class="s2">&quot;EOF1&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof1vector</span><span class="p">,</span> <span class="s2">&quot;EOF2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof2vector</span><span class="p">})</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%13.7f</span><span class="s2">&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="EOFDataForAllDOYs"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs">[docs]</a><span class="k">class</span> <span class="nc">EOFDataForAllDOYs</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class serves as a container for a series of EOF pairs, which covers all DOYs and provides some overall</span>
<span class="sd">    statistical quantities.</span>

<span class="sd">    The basic EOF computation function :py:func:`mjoindices.omi.omi_calculator.calc_eofs_from_olr` will return an object</span>
<span class="sd">    of this class as a major result of this package.</span>

<span class="sd">    The individual EOF pairs are represented by :class:`EOFData` objects.</span>

<span class="sd">    Note that the user can choose to consider or to ignore leap years in the data. This is probably of interest for the work</span>
<span class="sd">    with modeled data, since models might ignore leap years in idealized setups. Here, this means that the number of</span>
<span class="sd">    considered DOYs (and therefore the number of EOF pairs and further variables) can be either 365 or 366.</span>
<span class="sd">    The code in this package is designed to treat both cases consistently, however, the users should have their own</span>
<span class="sd">    choice in mind when working with the results.</span>

<span class="sd">    :param eof_list: A list with one :class:`EOFData` object for each DOY.</span>
<span class="sd">    :param no_leap_years: ``True`` if every year has 365 days, ``False`` if dataset contains leap years.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eof_list</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">EOFData</span><span class="p">],</span> <span class="n">no_leap_years</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">no_leap_years</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">eof_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">365</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;List of EOFs must contain 365 entries for no_leap_years=True&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="ow">not</span> <span class="n">no_leap_years</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">eof_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">366</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;List of EOFs must contain 366 entries for no_leap_years=False&quot;</span><span class="p">)</span> 

        <span class="k">if</span> <span class="n">no_leap_years</span><span class="p">:</span> 
            <span class="n">reference_list_len</span> <span class="o">=</span> <span class="mi">365</span> <span class="c1"># number of days in year</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reference_list_len</span> <span class="o">=</span> <span class="mi">366</span>
        <span class="n">reference_lat</span> <span class="o">=</span> <span class="n">eof_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span>
        <span class="n">reference_long</span> <span class="o">=</span> <span class="n">eof_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">long</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">reference_list_len</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">eof_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span> <span class="o">==</span> <span class="n">reference_lat</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All EOFs must have the same latitude grid. Problematic is DOY </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">eof_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">long</span> <span class="o">==</span> <span class="n">reference_long</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All EOFs must have the same longitude grid. Problematic is DOY </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
        <span class="c1"># deepcopy eofs so that they cannot be modified accidentally from outside after the consistency checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_eof_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">eof_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span> <span class="o">=</span> <span class="n">no_leap_years</span>

    <span class="c1"># FIXME: Could this property be used to modify the EOFData objects because they are mutual?</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eof_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">EOFData</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        EOF data for all DOYs as a list.</span>

<span class="sd">        Remember that DOY 1 corresponds to list entry 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eof_list</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">no_leap_years</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ``True`` if every year has 365 days, ``False`` if dataset contains leap years.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The latitude grid common to the EOFs of all DOYs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lat</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">long</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The longitude grid common to the EOFs of all DOYs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">long</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">len_eof_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Length of the ``eof_list``, based on ``no_leap_years``, i.e. the number of considered DOYs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">365</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">366</span>

<div class="viewcode-block" id="EOFDataForAllDOYs.eofdata_for_doy"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.eofdata_for_doy">[docs]</a>    <span class="k">def</span> <span class="nf">eofdata_for_doy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doy</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EOFData</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the :class:`EOFData` object for a particular DOY.</span>

<span class="sd">        :param doy: The DOY</span>

<span class="sd">        :return: The :class:`EOFData` object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof_list</span><span class="p">[</span><span class="n">doy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.eof1vector_for_doy"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.eof1vector_for_doy">[docs]</a>    <span class="k">def</span> <span class="nf">eof1vector_for_doy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doy</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shortcut to the EOF1 vector of a particular DOY.</span>

<span class="sd">        :param doy: The DOY.</span>

<span class="sd">        :return: The vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof_list</span><span class="p">[</span><span class="n">doy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">eof1vector</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.eof2vector_for_doy"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.eof2vector_for_doy">[docs]</a>    <span class="k">def</span> <span class="nf">eof2vector_for_doy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doy</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shortcut to the EOF2 vector of a particular DOY.</span>

<span class="sd">        :param doy: The DOY.</span>

<span class="sd">        :return: The vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof_list</span><span class="p">[</span><span class="n">doy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">eof2vector</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.explained_variance1_for_all_doys"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.explained_variance1_for_all_doys">[docs]</a>    <span class="k">def</span> <span class="nf">explained_variance1_for_all_doys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a vector containing the explained variance of EOF1 for each DOY.</span>

<span class="sd">        :return: The variance vector.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doys</span> <span class="o">=</span> <span class="n">doy_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">doys</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eofdata_for_doy</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">explained_variance_eof1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.explained_variance2_for_all_doys"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.explained_variance2_for_all_doys">[docs]</a>    <span class="k">def</span> <span class="nf">explained_variance2_for_all_doys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a vector containing the explained variance of EOF2 for each DOY.</span>

<span class="sd">        :return: The variance vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doys</span> <span class="o">=</span> <span class="n">doy_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">doys</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eofdata_for_doy</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">explained_variance_eof2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.total_explained_variance_for_all_doys"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.total_explained_variance_for_all_doys">[docs]</a>    <span class="k">def</span> <span class="nf">total_explained_variance_for_all_doys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a vector containing -for each DOY- the sum of the explained variance over all EOFs.</span>

<span class="sd">        :return: The variance vector. Should by close to 1 for each DOY if computation was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doys</span> <span class="o">=</span> <span class="n">doy_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">doys</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eofdata_for_doy</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">sum_of_explained_variances</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.no_observations_for_all_doys"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.no_observations_for_all_doys">[docs]</a>    <span class="k">def</span> <span class="nf">no_observations_for_all_doys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a vector containing -for each DOY- the number of observations that went into the</span>
<span class="sd">        computation of the EOFs.</span>

<span class="sd">        :return: The number of observations vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doys</span> <span class="o">=</span> <span class="n">doy_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">doys</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eofdata_for_doy</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">no_observations</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.eigenvalue1_for_all_doys"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.eigenvalue1_for_all_doys">[docs]</a>    <span class="k">def</span> <span class="nf">eigenvalue1_for_all_doys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a vector containing the eigenvalues of EOF1 for each DOY.</span>

<span class="sd">        :return: The eigenvalue vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doys</span> <span class="o">=</span> <span class="n">doy_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">doys</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eofdata_for_doy</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">eigenvalue_eof1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.eigenvalue2_for_all_doys"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.eigenvalue2_for_all_doys">[docs]</a>    <span class="k">def</span> <span class="nf">eigenvalue2_for_all_doys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a vector containing the eigenvalues of EOF2 for each DOY.</span>

<span class="sd">        :return: The eigenvalue vector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doys</span> <span class="o">=</span> <span class="n">doy_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">doys</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eofdata_for_doy</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">eigenvalue_eof2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.save_all_eofs_to_dir"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.save_all_eofs_to_dir">[docs]</a>    <span class="k">def</span> <span class="nf">save_all_eofs_to_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dirname</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the EOF1 and EOF2 data for each of the DOYs in the given directory.</span>

<span class="sd">        For each DOY, one text file will be created, which contains both EOFs.</span>
<span class="sd">        Note that the text files do not contain the eigenvalues and explained variance values. To save also those</span>
<span class="sd">        values, use the function :py:func:`save_all_eofs_to_npzfile`.</span>

<span class="sd">        :param dirname: The directory, where the files will be saved into.</span>
<span class="sd">        :param create_dir: If ``True``, the directory (and parent directories) will be created, if not existing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dirname</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">create_dir</span><span class="p">:</span>
            <span class="n">dirname</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">doy_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_leap_years</span><span class="p">):</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">dirname</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;eof</span><span class="si">%s</span><span class="s2">.txt&quot;</span> <span class="o">%</span> <span class="nb">format</span><span class="p">(</span><span class="n">doy</span><span class="p">,</span> <span class="s1">&#39;03&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eofdata_for_doy</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">save_eofs_to_txt_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="EOFDataForAllDOYs.save_all_eofs_to_npzfile"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.EOFDataForAllDOYs.save_all_eofs_to_npzfile">[docs]</a>    <span class="k">def</span> <span class="nf">save_all_eofs_to_npzfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the complete EOF data to a numpy file.</span>

<span class="sd">        :param filename: The filename.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doys</span> <span class="o">=</span> <span class="n">doy_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_no_leap_years</span><span class="p">)</span>
        <span class="n">eof1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">doys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">eof2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">doys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">doys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">explained_variances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">doys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">no_observations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">doys</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">doys</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="n">eof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eof_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">eof1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">eof</span><span class="o">.</span><span class="n">eof1vector</span>
            <span class="n">eof2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">eof</span><span class="o">.</span><span class="n">eof2vector</span>
            <span class="n">eigenvalues</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">eof</span><span class="o">.</span><span class="n">eigenvalues</span>
            <span class="n">explained_variances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">eof</span><span class="o">.</span><span class="n">explained_variances</span>
            <span class="n">no_observations</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">eof</span><span class="o">.</span><span class="n">no_observations</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span>
                 <span class="n">eof1</span><span class="o">=</span><span class="n">eof1</span><span class="p">,</span>
                 <span class="n">eof2</span><span class="o">=</span><span class="n">eof2</span><span class="p">,</span>
                 <span class="n">explained_variances</span><span class="o">=</span><span class="n">explained_variances</span><span class="p">,</span>
                 <span class="n">eigenvalues</span><span class="o">=</span><span class="n">eigenvalues</span><span class="p">,</span>
                 <span class="n">no_observations</span><span class="o">=</span><span class="n">no_observations</span><span class="p">,</span>
                 <span class="n">lat</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span>
                 <span class="n">long</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="load_single_eofs_from_txt_file"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.load_single_eofs_from_txt_file">[docs]</a><span class="k">def</span> <span class="nf">load_single_eofs_from_txt_file</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EOFData</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads a pair of EOFs, which was previously saved with this package (function :py:func:`EOFData.save_eofs_to_txt_file`).</span>

<span class="sd">    :param filename: Path to the  EOF file.</span>

<span class="sd">    :return: The pair of EOFs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">full_lat</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Lat</span><span class="o">.</span><span class="n">values</span>
    <span class="n">full_long</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Long</span><span class="o">.</span><span class="n">values</span>
    <span class="n">eof1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">EOF1</span><span class="o">.</span><span class="n">values</span>
    <span class="n">eof2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">EOF2</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># retrieve unique lat/long grids</span>
    <span class="c1"># FIXME: Does probably not work for a file with only one lat</span>
    <span class="n">lat</span><span class="p">,</span> <span class="n">repetition_idx</span><span class="p">,</span> <span class="n">rep_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">full_lat</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">long</span> <span class="o">=</span> <span class="n">full_long</span><span class="p">[</span><span class="n">repetition_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">repetition_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

    <span class="c1"># Apply some heuristic consistency checks</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rep_counts</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># All latitudes must have the same number of longitudes</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lat/Long grid in input file seems to be corrupted 1&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">repetition_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">repetition_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># All beginnings of a new lat have to be equally spaced</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lat/Long grid in input file seems to be corrupted 2&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">lat</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">long</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">eof1</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lat/Long grid in input file seems to be corrupted 3&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">long</span><span class="p">,</span> <span class="n">lat</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="n">full_long</span><span class="p">):</span>
        <span class="c1"># The longitude grid has to be the same for all latitudes</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lat/Long grid in input file seems to be corrupted 4&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">EOFData</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">eof1</span><span class="p">,</span> <span class="n">eof2</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_original_eofs_for_doy"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.load_original_eofs_for_doy">[docs]</a><span class="k">def</span> <span class="nf">load_original_eofs_for_doy</span><span class="p">(</span><span class="n">dirname</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">doy</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EOFData</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads the EOF values for the first 2 EOFs from the original file format.</span>

<span class="sd">    Note that the EOFs are represented as pure vectors in the original treatment, so that a connection to the</span>
<span class="sd">    individual locations on a world map is not obvious without any further knowledge. The corresponding grid is </span>
<span class="sd">    hardcoded in here.</span>

<span class="sd">    The original EOFs are found here: ftp://ftp.cdc.noaa.gov/Datasets.other/MJO/eof1/ and</span>
<span class="sd">    ftp://ftp.cdc.noaa.gov/Datasets.other/MJO/eof2/</span>

<span class="sd">    :param dirname: Path to the directory, in which the EOFs for all DOYs are stored.</span>
<span class="sd">        This path should contain the sub directories &quot;eof1&quot; and &quot;eof2&quot;, in which the 365 or 366 files each are located:</span>
<span class="sd">        One file per DOY.</span>
<span class="sd">    :param doy: DOY for which the 2 EOFs are loaded (number between 1 and 366).</span>

<span class="sd">    :return: The pair of EOFs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">orig_lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">orig_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">359.9</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
    <span class="n">eof1filename</span> <span class="o">=</span> <span class="n">dirname</span> <span class="o">/</span> <span class="s2">&quot;eof1&quot;</span> <span class="o">/</span> <span class="p">(</span><span class="s2">&quot;eof&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)</span>
    <span class="n">eof1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">eof1filename</span><span class="p">)</span>
    <span class="n">eof2filename</span> <span class="o">=</span> <span class="n">dirname</span> <span class="o">/</span> <span class="s2">&quot;eof2&quot;</span> <span class="o">/</span> <span class="p">(</span><span class="s2">&quot;eof&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)</span>
    <span class="n">eof2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">eof2filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">EOFData</span><span class="p">(</span><span class="n">orig_lat</span><span class="p">,</span> <span class="n">orig_long</span><span class="p">,</span> <span class="n">eof1</span><span class="p">,</span> <span class="n">eof2</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_all_eofs_from_directory"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.load_all_eofs_from_directory">[docs]</a><span class="k">def</span> <span class="nf">load_all_eofs_from_directory</span><span class="p">(</span><span class="n">dirname</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EOFDataForAllDOYs</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads the EOF functions (created with the function :py:func:`EOFDataForAllDOYs.save_all_eofs_to_dir`)</span>
<span class="sd">    for all DOYs from the given directory</span>

<span class="sd">    :param dirname: The directory in which the files are stored.</span>

<span class="sd">    :return: The EOFs for all DOYs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eofs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">doy_list</span><span class="p">(</span><span class="n">no_leap_years</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">dirname</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;eof</span><span class="si">%s</span><span class="s2">.txt&quot;</span> <span class="o">%</span> <span class="nb">format</span><span class="p">(</span><span class="n">doy</span><span class="p">,</span> <span class="s1">&#39;03&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">doy</span> <span class="o">&lt;</span> <span class="mi">366</span><span class="p">:</span>
            <span class="n">eof</span> <span class="o">=</span> <span class="n">load_single_eofs_from_txt_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">eofs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eof</span><span class="p">)</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># try to load DOY 366 from directory, if it exists. </span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">eof</span> <span class="o">=</span> <span class="n">load_single_eofs_from_txt_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">eofs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eof</span><span class="p">)</span>
                <span class="n">no_leap_years</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">no_leap_years</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;No EOFs from DOY 366 in directory. Assuming no leap years in dataset.&#39;</span><span class="p">)</span>            
    <span class="k">return</span> <span class="n">EOFDataForAllDOYs</span><span class="p">(</span><span class="n">eofs</span><span class="p">,</span> <span class="n">no_leap_years</span><span class="p">)</span> </div>


<div class="viewcode-block" id="load_all_original_eofs_from_directory"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.load_all_original_eofs_from_directory">[docs]</a><span class="k">def</span> <span class="nf">load_all_original_eofs_from_directory</span><span class="p">(</span><span class="n">dirname</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EOFDataForAllDOYs</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads the EOF functions for all DOYs from the original file format.</span>

<span class="sd">    The original EOFs are found here: ftp://ftp.cdc.noaa.gov/Datasets.other/MJO/eof1/ and</span>
<span class="sd">    ftp://ftp.cdc.noaa.gov/Datasets.other/MJO/eof2/</span>

<span class="sd">    Note that the EOFs are represented as pure vectors in the original treatment, so that a connection to the</span>
<span class="sd">    individual locations on a world map is not obvious without any further knowledge. The corresponding grid is</span>
<span class="sd">    hardcoded in here.</span>

<span class="sd">    :param dirname: Path to the directory, in which the EOFs for all DOYs are stored.</span>
<span class="sd">        This path should contain the sub directories &quot;eof1&quot; and &quot;eof2&quot;, in which the 366 files each are located:</span>
<span class="sd">        One file per day of the year.</span>

<span class="sd">    :return: The original EOFs for all DOYs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eofs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">doy_list</span><span class="p">(</span><span class="n">no_leap_years</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span> <span class="c1"># the original files contain leap years</span>
        <span class="n">eof</span> <span class="o">=</span> <span class="n">load_original_eofs_for_doy</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">doy</span><span class="p">)</span>
        <span class="n">eofs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eof</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">EOFDataForAllDOYs</span><span class="p">(</span><span class="n">eofs</span><span class="p">,</span> <span class="n">no_leap_years</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="restore_all_eofs_from_npzfile"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.restore_all_eofs_from_npzfile">[docs]</a><span class="k">def</span> <span class="nf">restore_all_eofs_from_npzfile</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EOFDataForAllDOYs</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads all EOF data from a numpy file, which was written with :py:func:`EOFDataForAllDOYs.save_all_eofs_to_npzfile`.</span>

<span class="sd">    :param filename: The filename.</span>

<span class="sd">    :return: The EOFs for all DOYs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">eof1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;eof1&quot;</span><span class="p">]</span>
        <span class="n">eof2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;eof2&quot;</span><span class="p">]</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span>
        <span class="n">long</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;long&quot;</span><span class="p">]</span>
        <span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;eigenvalues&quot;</span><span class="p">]</span>
        <span class="n">explained_variances</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;explained_variances&quot;</span><span class="p">]</span>
        <span class="n">no_observations</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;no_observations&quot;</span><span class="p">]</span>
    <span class="n">eofs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">eof1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">365</span><span class="p">:</span>
        <span class="n">no_leap_years</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># sets True if no leap years in dataset. </span>
    <span class="k">elif</span> <span class="n">eof1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">366</span><span class="p">:</span>
        <span class="n">no_leap_years</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Dataset does not have EOFs from each day of year.&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">doy_list</span><span class="p">(</span><span class="n">no_leap_years</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">eof</span> <span class="o">=</span> <span class="n">EOFData</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">eof1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">eof2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span>
                      <span class="n">eigenvalues</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span>
                      <span class="n">explained_variances</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">explained_variances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span>
                      <span class="n">no_observations</span><span class="o">=</span><span class="n">no_observations</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">eofs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eof</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">EOFDataForAllDOYs</span><span class="p">(</span><span class="n">eofs</span><span class="p">,</span> <span class="n">no_leap_years</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_explained_variance_for_all_doys"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.plot_explained_variance_for_all_doys">[docs]</a><span class="k">def</span> <span class="nf">plot_explained_variance_for_all_doys</span><span class="p">(</span><span class="n">eofs</span><span class="p">:</span> <span class="n">EOFDataForAllDOYs</span><span class="p">,</span> <span class="n">include_total_variance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                         <span class="n">include_no_observations</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the explained variance values for EOF1 and EOF2 for all DOYs.</span>

<span class="sd">    Comparable to :ref:`refKiladis2014`, Fig. 1 (although the values there are too high by a factor of 2). See</span>
<span class="sd">    :ref:`refKiladis2020` for the correct original values.</span>

<span class="sd">    :param eofs: The EOF data to plot.</span>

<span class="sd">    :return: Handle to the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">doygrid</span> <span class="o">=</span> <span class="n">doy_list</span><span class="p">(</span><span class="n">eofs</span><span class="o">.</span><span class="n">no_leap_years</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;plot_explained_variance_for_all_doys&quot;</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">handles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">p1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">doygrid</span><span class="p">,</span> <span class="n">eofs</span><span class="o">.</span><span class="n">explained_variance1_for_all_doys</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;EOF1&quot;</span><span class="p">)</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">p2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">doygrid</span><span class="p">,</span> <span class="n">eofs</span><span class="o">.</span><span class="n">explained_variance2_for_all_doys</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;EOF2&quot;</span><span class="p">)</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_total_variance</span><span class="p">:</span>
        <span class="n">p3</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">doygrid</span><span class="p">,</span> <span class="n">eofs</span><span class="o">.</span><span class="n">total_explained_variance_for_all_doys</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Total&quot;</span><span class="p">)</span>
        <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;DOY&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fraction of explained variance&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">eofs</span><span class="o">.</span><span class="n">len_eof_list</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">include_no_observations</span><span class="p">:</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">p4</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">doygrid</span><span class="p">,</span> <span class="n">eofs</span><span class="o">.</span><span class="n">no_observations_for_all_doys</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Number of observations&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
        <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p4</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Number of observations&quot;</span><span class="p">)</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">eofs</span><span class="o">.</span><span class="n">no_observations_for_all_doys</span><span class="p">())</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">eofs</span><span class="o">.</span><span class="n">no_observations_for_all_doys</span><span class="p">())</span> <span class="o">*</span> <span class="mf">0.1</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">eofs</span><span class="o">.</span><span class="n">no_observations_for_all_doys</span><span class="p">())</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">eofs</span><span class="o">.</span><span class="n">no_observations_for_all_doys</span><span class="p">())</span> <span class="o">*</span> <span class="mf">0.1</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Explained variance&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">handles</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot_eigenvalues_for_all_doys"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.plot_eigenvalues_for_all_doys">[docs]</a><span class="k">def</span> <span class="nf">plot_eigenvalues_for_all_doys</span><span class="p">(</span><span class="n">eofs</span><span class="p">:</span> <span class="n">EOFDataForAllDOYs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the Eigenvalues for EOF1 and EOF2 for all DOYs.</span>

<span class="sd">    :param eofs: The EOF data to plot.</span>

<span class="sd">    :return: Handle to the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">doygrid</span> <span class="o">=</span> <span class="n">doy_list</span><span class="p">(</span><span class="n">eofs</span><span class="o">.</span><span class="n">no_leap_years</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;plot_eigenvalues_for_all_doys&quot;</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">p1</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">doygrid</span><span class="p">,</span> <span class="n">eofs</span><span class="o">.</span><span class="n">eigenvalue1_for_all_doys</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;EOF1&quot;</span><span class="p">)</span>
    <span class="n">p2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">doygrid</span><span class="p">,</span> <span class="n">eofs</span><span class="o">.</span><span class="n">eigenvalue2_for_all_doys</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;EOF2&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;DOY&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Eigenvalue&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Eigenvalues&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot_original_individual_eof_map"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.plot_original_individual_eof_map">[docs]</a><span class="k">def</span> <span class="nf">plot_original_individual_eof_map</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">doy</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a pair of original EOFs, which are loaded from a directory, in two maps.</span>

<span class="sd">    :param path: The directory with the EOF data (see :py:func:`load_original_eofs_for_doy` for details).</span>
<span class="sd">    :param doy: The corresponding DOY. Only used to display it in the title.</span>

<span class="sd">    :return: Handle to the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eofdata</span> <span class="o">=</span> <span class="n">load_original_eofs_for_doy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">doy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plot_individual_eof_map</span><span class="p">(</span><span class="n">eofdata</span><span class="p">,</span> <span class="n">doy</span><span class="o">=</span><span class="n">doy</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_individual_eof_map_from_file"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.plot_individual_eof_map_from_file">[docs]</a><span class="k">def</span> <span class="nf">plot_individual_eof_map_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">doy</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a pair of EOFs, which are loaded from a file, in two maps.</span>

<span class="sd">    :param filename: The file with the EOF data.</span>
<span class="sd">    :param doy: The corresponding DOY. Only used to display it in the title.</span>

<span class="sd">    :return: Handle to the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eofdata</span> <span class="o">=</span> <span class="n">load_single_eofs_from_txt_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">doy</span><span class="o">=</span><span class="n">doy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plot_individual_eof_map</span><span class="p">(</span><span class="n">eofdata</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_individual_eof_map"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.plot_individual_eof_map">[docs]</a><span class="k">def</span> <span class="nf">plot_individual_eof_map</span><span class="p">(</span><span class="n">eofdata</span><span class="p">:</span> <span class="n">EOFData</span><span class="p">,</span> <span class="n">doy</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a pair of EOFs for a particular DOY in two maps.</span>

<span class="sd">    :param eofdata: The EOF data to plot.</span>
<span class="sd">    :param doy: The corresponding DOY. Only used to display it in the title.</span>

<span class="sd">    :return: Handle to the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Plot underlying map</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="s2">&quot;plotting.plot_eof_for_doy&quot;</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">doy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;EOF Recalculation for DOY </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">doy</span><span class="p">)</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">eofdata</span><span class="o">.</span><span class="n">long</span><span class="p">,</span> <span class="n">eofdata</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">eofdata</span><span class="o">.</span><span class="n">eof1map</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;bwr&quot;</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;OLR Anomaly [W/m]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;EOF1&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude []&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude []&quot;</span><span class="p">)</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">eofdata</span><span class="o">.</span><span class="n">long</span><span class="p">,</span> <span class="n">eofdata</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">eofdata</span><span class="o">.</span><span class="n">eof2map</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;bwr&quot;</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;OLR Anomaly [W/m]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;EOF2&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude []&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude []&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot_individual_explained_variance_all_eofs"><a class="viewcode-back" href="../../api/empirical_orthogonal_functions.html#mjoindices.empirical_orthogonal_functions.plot_individual_explained_variance_all_eofs">[docs]</a><span class="k">def</span> <span class="nf">plot_individual_explained_variance_all_eofs</span><span class="p">(</span><span class="n">eof</span><span class="p">:</span> <span class="n">EOFData</span><span class="p">,</span> <span class="n">doy</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_eof_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the explained variances for each EOF function, but only for EOF data of one DOY.</span>

<span class="sd">    This is useful to confirm that the first 2 EOFs cover actually most of the variance.</span>

<span class="sd">    :param eof: The EOF data.</span>
<span class="sd">    :param doy: The corresponding DOY. Only used to display it in the title.</span>
<span class="sd">    :param max_eof_number: The limit of the x-axis.</span>

<span class="sd">    :return: Handle to the figure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eof_number_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">eof</span><span class="o">.</span><span class="n">explained_variances</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s2">&quot;plot_individual_explained_variance_all_eofs&quot;</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eof_number_grid</span><span class="p">,</span> <span class="n">eof</span><span class="o">.</span><span class="n">explained_variances</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Explained variance&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_eof_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_eof_number</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;EOF Number&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fraction of explained variance&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s2">&quot;Sum over all EOFs: </span><span class="si">%1.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eof</span><span class="o">.</span><span class="n">sum_of_explained_variances</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">doy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Explained variance for DOY </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">doy</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Explained variance&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Christoph G. Hoffmann.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>